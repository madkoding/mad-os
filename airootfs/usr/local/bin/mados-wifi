#!/bin/bash
# madOS WiFi Configuration - Launcher script

# Ensure iwd service is running
if ! systemctl is-active --quiet iwd.service 2>/dev/null; then
    systemctl start iwd.service 2>/dev/null
    sleep 1
fi

# Unblock WiFi rfkill (common on MT7921 and other combo adapters)
rfkill unblock wifi 2>/dev/null

# Ensure WiFi modules are loaded (MediaTek MT7921/MT7922)
modprobe mt7921e 2>/dev/null
modprobe mt7921s 2>/dev/null
modprobe mt7921u 2>/dev/null

export PYTHONPATH="/usr/local/lib${PYTHONPATH:+:$PYTHONPATH}"
exec python3 -m mados_wifi "$@"
